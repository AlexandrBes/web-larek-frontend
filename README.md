# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Архитектура
Компоненты архитектуры образуют шаблон проектирования Model-View-Presenter(MVP):
- Базовый код: отвечает за связь данных и представления.
- Компонент модели данных: отвечает за хранение и изменение данных.
- Компоненты представления: отвечает за отображение данных на странице.

### Базовый код 

#### Класс `Api` 
Отправляет запросы HTTP серверу. Содержит методы для отправки данных и обработки ответов сервера.

Конструктор принимает такие аргументы:
1. `baseUrl: string` - получает и хранит базовый url.
2. `options: RequestInit` - опции запроса.

Класс имеет такие методы:
1. `protected handleResponse(response: Response): Promise` - обработывает ответ сервера.
2. `get(url: string)` - забирает данные c сервера.
3. `post(url: string, data: object, method: ApiPostMethods = 'POST')` - отправляет данные на сервер.

#### Класс `EventEmitter`
Он позволяет объектам подписываться на события и реагировать.

Основные методы описаные интерфейсом `IEvents`:
1. `on` - подписка на событие.
2. `emit` - инициализация события.
3. `trigger` - возвращает функции, при вызове инициализирует событие.
<br>

### Компоненты модели данных(бизнес-логика)
Хранилище с набором данных для контроля работы приложения.

#### Класс `AppState`
Устанавливает связь между товарами, корзиной, заказом и ошибок ввода.

Поля класса:
 1. `catalog: IProduct[]` - массив товаров.
 2. `basket: IProduct[]` - корзина с товарами.
 3. `order: IOrder` - информация о заказе.
 4. `preview: string` - предосмотр товара.
 5. `loading: boolean` - загрузка товара.
 6. `formErrors: FormErrors` - ошибки ввода данных в форме заказа.
 7. `priceBasket: number` - общая стоимость товара в корзине.
    
Методы класса:
1. `pushToBasket(id: string)` - добавление товара в список заказаных.
2. `deleteFromBasket(id: string)` - удаление товара из списка заказных.
3. `basketProduct(id: string): boolean` - проверяет есть ли товар в списке заказаных.
4. `addToBasket(item: IProduct)` - добавление товара в корзину.
5. `clearBasket()` - очистить корзину. 
6. `getTotalPriceBasket(): number` - сумма товара в корзине.
7. `setCatalogProduct(item: IProduct[])` - вывод товара в каталог.
8. `getCurrentOrder()` - введеные в форме данные заказа проверяет на валидность, если есть ошибка сработает событие formError и вернет false, иначе true
9. `setOrderField(field: keyof IOrderForm, value: string)` - Проверяет валидность данных и устанавливает значение в поле формы заказа, если ошибки нет сработает событие order: true.


<br>

### Компоненты представления

#### Класс `Component` 
Базовый компонент который принимает родительские элементы.

#### Класс `ProductCard`
Выводит товар и информацию о нем.

Конструктор принимает такие аргументы:
Инициализирует карточку, настраивает элементы и добавляет слушатель событий, если необходимо.
1. `blockName: string` - имя блока.
2. `container: HTMLElement` - контейнер карточки. 
3. `actions?: ICardActions` - опциональное действие.

Поля класса:
1. `image: HTMLImageElement` - изображения карточки.
2. `title: HTMLElement` -  заголовка товара.
3. `description: HTMLElement` - описания товара.
4. `category: HTMLElement` - категории товара.
5. `price: HTMLElement` - цены товара.
6. `button: HTMLButtonElement` - кнопка на карточке товара.

Методы класса:
1. `setImage(image: HTMLImageElement, src: string, alt: string)` - устанавливаем изображение карточки с альтер. текстом.
2. `set image(value: string)` - устанавливаем изображение карточки.
3. `set title(value: string)` - устанавливаем заголовок карточки.
4. `get title(): string` - возвращаем заголовок карточки.
5. `set description(value: string | string[])` - устанавливаем описание карточки.
6. `setPriceText(price: HTMLElement, value: number | null)` - устанавливаем текст цены карточки.
7. `set price(value: number | null)` - устанавливаем цену товара.
8. `get price(): number | string` - возвращаем цену товара.
9. `set button(value: HTMLButtonElement)` - устанавливаем кнопку карточки.
10. `toggleButtonState(button: HTMLButtonElement, isEnabled: boolean)` - устанавливаем состояние кнопки.
11. `etTextCategory(element: HTMLElement, text: string)` - устанавливаем текст категории карточки.
12. `set id(value: string)` - устанавливаем идентификатор карточки.
13. `get id(): string` - возвращаем идентификатор карточки.

#### Класс `Page` - отображает главную страницу сайта, каталог товаров и счетчик сайта.
#### Класс `Basket` - отображает информацию по заказу и отвечает за работу корзины.
#### Класс `Modal` - открытие и закрытие модульных окон и вывод в них контента.
#### Класс `Form` - форма оформления заказа.
#### Класс `Order` - форма со способом оплаты и адресом доставки.
#### Класс `ContactForm` - форма с номером телефона и почтой.
#### Класс `Succes` - сообщение об успешном оформление заказа.
